# Spectra_exploration
This code executes data extraction from Gaussian .log files needed to explore states and makes spectra data visualisation and contains the following functions:
    extract_data,
    get_orbitals_chart,
    get_rvel_chart,
    get_elect_dipole_chart,
    get_magnet_dipole_chart,
    get_em_angle_chart,
    get_spectra


  ## extract_data
    This function exctract information from .log files generated by Gaussian

    data_r_vel.xlsx  - contains information about R_vel
    data_elect_dipole.xlsx - contains information about electrical dipoles
    data_magnet_dipole.xlsx - contains information about magnetic dipoles
    data_em_angle.xlsx - contains information about the angle between electrical dipoles and magnetic dipoles
    data_homo_lumo.xlsx - contains information about HOMO and LUMO orbitals

    Parameters:
    - subpath (str): path to folder that conatains all .log files that need to be extragated
    - states (list): List of states needed. Default [3, 4]
    - r_vel_states_numbe (int) - number of r_vel needed to be extragated. Default 6

    Returns:
    generates 5 .xlsx files:
    - data_r_vel.xlsx  - contains information about R_vel
    - data_elect_dipole.xlsx - contains information about electrical dipoles
    - data_magnet_dipole.xlsx - contains information about magnetic dipoles
    - data_em_angle.xlsx - contains information about the angle between electrical dipoles and magnetic dipoles
    - data_homo_lumo.xlsx - contains information about HOMO and LUMO orbitals
    
  
  ## get_orbitals_chart
    Creates a chart for HOMO - LUMO orbitals by taking data from data_homo_lumo.xlsx file

        Parameters:
    - subpath (str): path to folder that conatains data_homo_lumo.xlsx file
    - x_title (str): X title of the chart is "Dihedral angle" + x_title + ", degree". Default "
    - y_lim_1 (list) - list of 2 numbers for HOMO chart [lower_limit, upper_limit]. Default None
    - y_lim_2 (list) - list of 2 numbers for LUMO chart [lower_limit, upper_limit]. Default None
    - conformers_names (bool) - if all conformer names are int (rotation angles etc) - True, else - False. Default - False

        Returns:
    - creates a folder images (if not creates) and saves /images/orbitals.png chart
  
  ## get_rvel_chart

     Creates a chart for R_vel by taking data from data_r_vel.xlsx file

        Parameters:
    - subpath (str): path to folder that conatains data_r_vel.xlsx file
    - states (list): List of states needed to be on the plot. Default [3, 4]
    - x_title (str): X title of the chart is "Dihedral angle" + x_title + ", degree" Default ""
    - y_lim (list): list of 2 numbers [lower_limit, upper_limit]. Default None
    - show_legend (bool): If True - shows legend, False - does not show legend. Default True
    - conformers_names (bool) - if all conformer names are int (rotation angles etc) - True, else - False. Default - False

        Returns:
    - creates a folder images (if not creates) and saves /images/r_vel.png chart

  
  ## get_elect_dipole_chart
    Creates a chart for electrical dipole by taking data from data_elect_dipole.xlsx file

        Parameters:
    - subpath (str): path to folder that conatains data_elect_dipole.xlsx file
    - states (list): List of states needed to be on the plot. Default [3, 4]
    - x_title (str): X title of the chart is "Dihedral angle" + x_title + ", degree" Default ""
    - y_lim (list): list of 2 numbers [lower_limit, upper_limit]. Default None
    -  fig_width: (int): width of the chart. Default None
    - conformers_names (bool) - if all conformer names are int (rotation angles etc) - True, else - False. Default - False

        Returns:
    - creates a folder images (if not creates) and saves /images/elect_dipole.png chart

  
  ## get_magnet_dipole_chart

      Creates a chart for magnetic dipole by taking data from data_magnet_dipole.xlsx file

        Parameters:
    - subpath (str): path to folder that conatains data_magnet_dipole.xlsx file
    - states (list): List of states needed to be on the plot. Default [3, 4]
    - x_title (str): X title of the chart is "Dihedral angle" + x_title + ", degree" Default ""
    - y_lim (list): list of 2 numbers [lower_limit, upper_limit]. Default None
    -  fig_width: (int): width of the chart. Default None
    - conformers_names (bool) - if all conformer names are int (rotation angles etc) - True, else - False. Default - False

        Returns:
    - creates a folder images (if not creates) and saves /images/magnet_dipole.png chart
  
  ## get_em_angle_chart

    Creates a chart for angle between electric and magnetic dipole by taking data from data_em_angle.xlsx file

        Parameters:
    - subpath (str): path to folder that conatains data_em_angle.xlsx file
    - states (list): List of states needed to be on the plot. Default [3, 4]
    - x_title (str): X title of the chart is "Dihedral angle" + x_title + ", degree" Default ""
    - y_lim (list): list of 2 numbers [lower_limit, upper_limit]. Default None
    -  fig_width: (int): width of the chart. Default None
    - show_legend (bool): If True - shows legend, False - does not show legend. Default True
    - conformers_names (bool) - if all conformer names are int (rotation angles etc) - True, else - False. Default - False

        Returns:
    - creates a folder images (if not creates) and saves /images/em_angle.png chart
  
  ## get_spectra
    Creates a chart with ecd spectra from Gaussian .txt files

        Parameters:
    - subpath (str): path to folder that conatains Gaussian ecd .txt file
    - x_lim (list): list of 2 numbers [left_limit, right_limit]. Default [None, None]    
    - y_lim (list) / y_lim_ecd (list) - for CLI version: list of 2 numbers [lower_limit, upper_limit]. Default [None, None]  
    - special_style: (list): ECD for conformers in this list will be plotted with dashed line
    - legend_from_file (str): file name with legend. Default None 

        Returns:
    - creates spectra.png chart
    - dataframe with all ecd spectra from folder

